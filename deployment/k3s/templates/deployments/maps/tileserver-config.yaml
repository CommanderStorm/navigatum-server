kind: ConfigMap
apiVersion: v1
metadata:
  name: tileserver-config
  namespace: {{ $.Values.namespace }}
data:
  osm_liberty.json: |-
{{ .Files.Get "files/maps/osm_liberty.json" | indent 4 }}
  sprites_osm_liberty.json: |-
{{ .Files.Get "files/maps/sprites/osm_liberty.json" | indent 4 }}
  sprites_osm_liberty@2x.json: |-
{{ .Files.Get "files/maps/sprites/osm_liberty@2x.json" | indent 4 }}
  sprites_osm_liberty.png: |-
{{ .Files.Get "files/maps/sprites/osm_liberty.png" | indent 4 }}
  sprites_osm_liberty@2x.png: |-
{{ .Files.Get "files/maps/sprites/osm_liberty@2x.png" | indent 4 }}
  config.json: |-
    {
      "options": {
        "paths": {
          "root": "",
          "fonts": "fonts",
          "sprites": "sprites",
          "styles": "styles",
          "mbtiles": ""
        },
        "domains": [
          "{{ $.Values.url }}",
          "localhost:8080",
          "127.0.0.1:8080"
        ],
        "formatQuality": {
          "jpeg": 80,
          "webp": 90
        },
        "maxScaleFactor": 2,
        "minRendererPoolSizes": [2, 4],
        "maxRendererPoolSizes": [2, 4],
        "maxSize": 2048,
        "pbfAlias": "pbf",
        "serveAllFonts": true,
        "serveAllStyles": true,
        "serveStaticMaps": true,
        "tileMargin": 0
      },
      "styles": {
        "osm_liberty": {
          "style": "osm_liberty.json",
          "serve_rendered": true,
          "serve_data": true,
          "tilejson": {
            "format": "png"
          }
        }
      },
      "data": {
        "openmaptiles": {
          "mbtiles": "output.mbtiles"
        }
      }
    }
